## Breach 01

This is the first attacker that has come across my honeypot so far (not even 24 hours after I set it up). It seems pretty low sophistication. The attacker successfully guessed a weak password for user root on SSH. Almost immediately a bash one liner was executed (it's in the cowrie.json file). It looked for any writable directories in the root file (/). It changed into the first writable directory it found. The malicious script proceeded to use curl to download a ELF executable, give it executable permissions, and execute it. Interestingly, it then repeated the process but using wget instead. It also uses a wget-like syntax to download the file, but replaces the wget command with "good." The three files downloaded have identical MD5 checksums and the URL requested is the same, which means the same file is downloaded either way. The filenames were the same as well, except the last character was different. This could indicate a few things. A possibility is that the attacker simply isn't proficient enough in bash scripting to include a way to check whether wget or curl is installed and react accordingly. This seeems like the most likely scenario. It could also be because the attacker wanted to keep the script simple or small in size, although this seems unlikely.
  The executable(s) that are downloaded are an interesting piece of data I haven't looked over carefully yet. I uploaded them to virustotal, and they weren't detected by any AV software. If anyone would like to analyze them, feel free to contact me on twitter (@nschon91). The script repeats a similar process, but downloads a different file this time. It is also an ELF executable. The one liner changes the permissions of the executable to allow it to run, and runs it. 
  To clean up its' tracks the script tries to destroy log files. It uses this command: `cat /dev/null > /var/log/example.log` to erase several log files and the user bash history. Finally it uses 'ls' to list a specific file (/etc/daemon.cfg) and uses the return status of this command as the exit status of the script. The IP address used for all communication (including downloading of files and the original breach with SSH) didn't appear on any blacklists I searched. It seems to be some kind of cloud hosting provider in Hong Kong. This IP may merely be a proxy for the true IP of the attacker. The attack seemed to be some kind of automated tool. I determined this based on the speed the honeypot was breached and the one liner executed. Cowrie allows you to replay the shell session of the attacker. The commands happened too fast to read, so chances are this was some kind of script or tool.
